<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Correlation and Regression | Statistical Analysis and Visualizations Using R</title>
  <meta name="description" content="This book contains the materials for the R training at the Technology Training Centre." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Correlation and Regression | Statistical Analysis and Visualizations Using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book contains the materials for the R training at the Technology Training Centre." />
  <meta name="github-repo" content="okanbulut/rbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Correlation and Regression | Statistical Analysis and Visualizations Using R" />
  
  <meta name="twitter:description" content="This book contains the materials for the R training at the Technology Training Centre." />
  

<meta name="author" content="Okan Bulut" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="part5.html"/>
<link rel="next" href="part7.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://www.ualberta.ca/technology-training/">Okan Bulut &copy;</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i><b>1.1</b> Course Description</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-objectives"><i class="fa fa-check"></i><b>1.2</b> Course Objectives</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#instructor-information"><i class="fa fa-check"></i><b>1.3</b> Instructor Information</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-structure"><i class="fa fa-check"></i><b>1.4</b> Course Structure</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#course-materials"><i class="fa fa-check"></i><b>1.5</b> Course Materials</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#learning-process"><i class="fa fa-check"></i><b>1.6</b> Learning Process</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#additional-resources"><i class="fa fa-check"></i><b>1.7</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="part1.html"><a href="part1.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="part1.html"><a href="part1.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> R and RStudio</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="part1.html"><a href="part1.html#what-is-r"><i class="fa fa-check"></i><b>2.1.1</b> What is <strong>R</strong>?</a></li>
<li class="chapter" data-level="2.1.2" data-path="part1.html"><a href="part1.html#what-is-rstudio"><i class="fa fa-check"></i><b>2.1.2</b> What is RStudio?</a></li>
<li class="chapter" data-level="2.1.3" data-path="part1.html"><a href="part1.html#download-and-install"><i class="fa fa-check"></i><b>2.1.3</b> Download and Install</a></li>
<li class="chapter" data-level="2.1.4" data-path="part1.html"><a href="part1.html#preview-of-rstudio"><i class="fa fa-check"></i><b>2.1.4</b> Preview of RStudio</a></li>
<li class="chapter" data-level="2.1.5" data-path="part1.html"><a href="part1.html#creating-a-new-script"><i class="fa fa-check"></i><b>2.1.5</b> Creating a New Script</a></li>
<li class="chapter" data-level="2.1.6" data-path="part1.html"><a href="part1.html#working-directory"><i class="fa fa-check"></i><b>2.1.6</b> Working Directory</a></li>
<li class="chapter" data-level="2.1.7" data-path="part1.html"><a href="part1.html#downloading-and-installing-r-packages"><i class="fa fa-check"></i><b>2.1.7</b> Downloading and Installing <strong>R</strong> Packages</a></li>
<li class="chapter" data-level="2.1.8" data-path="part1.html"><a href="part1.html#exercise-1"><i class="fa fa-check"></i><b>2.1.8</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="part1.html"><a href="part1.html#basics-of-the-r-language"><i class="fa fa-check"></i><b>2.2</b> Basics of the R Language</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="part1.html"><a href="part1.html#creating-new-variables"><i class="fa fa-check"></i><b>2.2.1</b> Creating New Variables</a></li>
<li class="chapter" data-level="2.2.2" data-path="part1.html"><a href="part1.html#important-rules-for-the-r-language"><i class="fa fa-check"></i><b>2.2.2</b> Important Rules for the <strong>R</strong> Language</a></li>
<li class="chapter" data-level="2.2.3" data-path="part1.html"><a href="part1.html#self-help"><i class="fa fa-check"></i><b>2.2.3</b> Self-Help</a></li>
<li class="chapter" data-level="2.2.4" data-path="part1.html"><a href="part1.html#exercise-2"><i class="fa fa-check"></i><b>2.2.4</b> Exercise 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="part2.html"><a href="part2.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="part2.html"><a href="part2.html#creating-datasets-in-r"><i class="fa fa-check"></i><b>3.1</b> Creating Datasets in <strong>R</strong></a></li>
<li class="chapter" data-level="3.2" data-path="part2.html"><a href="part2.html#importing-data-into-r"><i class="fa fa-check"></i><b>3.2</b> Importing Data into <strong>R</strong></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="part2.html"><a href="part2.html#method-1-using-rstudio"><i class="fa fa-check"></i><b>3.2.1</b> Method 1: Using <strong>RStudio</strong></a></li>
<li class="chapter" data-level="3.2.2" data-path="part2.html"><a href="part2.html#method-2-using-r-commands"><i class="fa fa-check"></i><b>3.2.2</b> Method 2: Using <strong>R</strong> Commands</a></li>
<li class="chapter" data-level="3.2.3" data-path="part2.html"><a href="part2.html#exercise-3"><i class="fa fa-check"></i><b>3.2.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="part2.html"><a href="part2.html#understanding-the-data"><i class="fa fa-check"></i><b>3.3</b> Understanding the Data</a></li>
<li class="chapter" data-level="3.4" data-path="part2.html"><a href="part2.html#indexing"><i class="fa fa-check"></i><b>3.4</b> Indexing</a></li>
<li class="chapter" data-level="3.5" data-path="part2.html"><a href="part2.html#subsetting"><i class="fa fa-check"></i><b>3.5</b> Subsetting</a></li>
<li class="chapter" data-level="3.6" data-path="part2.html"><a href="part2.html#other-data-manipulation-tools"><i class="fa fa-check"></i><b>3.6</b> Other Data Manipulation Tools</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="part2.html"><a href="part2.html#exercise-4"><i class="fa fa-check"></i><b>3.6.1</b> Exercise 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="part3.html"><a href="part3.html"><i class="fa fa-check"></i><b>4</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="part3.html"><a href="part3.html#quick-summary"><i class="fa fa-check"></i><b>4.1</b> Quick Summary</a></li>
<li class="chapter" data-level="4.2" data-path="part3.html"><a href="part3.html#frequency-tables"><i class="fa fa-check"></i><b>4.2</b> Frequency Tables</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="part3.html"><a href="part3.html#exercise-5"><i class="fa fa-check"></i><b>4.2.1</b> Exercise 5</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="part3.html"><a href="part3.html#central-tendency-and-dispersion"><i class="fa fa-check"></i><b>4.3</b> Central Tendency and Dispersion</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="part3.html"><a href="part3.html#exercise-6"><i class="fa fa-check"></i><b>4.3.1</b> Exercise 6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="part4.html"><a href="part4.html"><i class="fa fa-check"></i><b>5</b> Data Visualizations in <strong>R</strong></a>
<ul>
<li class="chapter" data-level="5.1" data-path="part4.html"><a href="part4.html#base-r-graphics"><i class="fa fa-check"></i><b>5.1</b> Base <strong>R</strong> Graphics</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="part4.html"><a href="part4.html#boxplots"><i class="fa fa-check"></i><b>5.1.1</b> Boxplots</a></li>
<li class="chapter" data-level="5.1.2" data-path="part4.html"><a href="part4.html#histograms"><i class="fa fa-check"></i><b>5.1.2</b> Histograms</a></li>
<li class="chapter" data-level="5.1.3" data-path="part4.html"><a href="part4.html#bar-graphs"><i class="fa fa-check"></i><b>5.1.3</b> Bar Graphs</a></li>
<li class="chapter" data-level="5.1.4" data-path="part4.html"><a href="part4.html#scatterplots"><i class="fa fa-check"></i><b>5.1.4</b> Scatterplots</a></li>
<li class="chapter" data-level="5.1.5" data-path="part4.html"><a href="part4.html#scatterplots-boxplots"><i class="fa fa-check"></i><b>5.1.5</b> Scatterplots + Boxplots</a></li>
<li class="chapter" data-level="5.1.6" data-path="part4.html"><a href="part4.html#scatterplot-matrix"><i class="fa fa-check"></i><b>5.1.6</b> Scatterplot Matrix</a></li>
<li class="chapter" data-level="5.1.7" data-path="part4.html"><a href="part4.html#saving-base-r-figures"><i class="fa fa-check"></i><b>5.1.7</b> Saving Base <strong>R</strong> Figures</a></li>
<li class="chapter" data-level="5.1.8" data-path="part4.html"><a href="part4.html#exercise-7"><i class="fa fa-check"></i><b>5.1.8</b> Exercise 7</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="part4.html"><a href="part4.html#ggplot2-graphics"><i class="fa fa-check"></i><b>5.2</b> <code>ggplot2</code> Graphics</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="part4.html"><a href="part4.html#what-is-ggplot2"><i class="fa fa-check"></i><b>5.2.1</b> What is <code>ggplot2</code>?</a></li>
<li class="chapter" data-level="5.2.2" data-path="part4.html"><a href="part4.html#how-ggplot2-works"><i class="fa fa-check"></i><b>5.2.2</b> How <code>ggplot2</code> works?</a></li>
<li class="chapter" data-level="5.2.3" data-path="part4.html"><a href="part4.html#scatterplots-1"><i class="fa fa-check"></i><b>5.2.3</b> Scatterplots</a></li>
<li class="chapter" data-level="5.2.4" data-path="part4.html"><a href="part4.html#boxplots-1"><i class="fa fa-check"></i><b>5.2.4</b> Boxplots</a></li>
<li class="chapter" data-level="5.2.5" data-path="part4.html"><a href="part4.html#histograms-1"><i class="fa fa-check"></i><b>5.2.5</b> Histograms</a></li>
<li class="chapter" data-level="5.2.6" data-path="part4.html"><a href="part4.html#bar-plots"><i class="fa fa-check"></i><b>5.2.6</b> Bar Plots</a></li>
<li class="chapter" data-level="5.2.7" data-path="part4.html"><a href="part4.html#exercise-8"><i class="fa fa-check"></i><b>5.2.7</b> Exercise 8</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="part5.html"><a href="part5.html"><i class="fa fa-check"></i><b>6</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="6.1" data-path="part5.html"><a href="part5.html#some-theory"><i class="fa fa-check"></i><b>6.1</b> Some Theory</a></li>
<li class="chapter" data-level="6.2" data-path="part5.html"><a href="part5.html#types-of-inferential-statistics"><i class="fa fa-check"></i><b>6.2</b> Types of Inferential Statistics</a></li>
<li class="chapter" data-level="6.3" data-path="part5.html"><a href="part5.html#one-sample-t-test"><i class="fa fa-check"></i><b>6.3</b> One-Sample <span class="math inline">\(t\)</span> Test</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="part5.html"><a href="part5.html#example"><i class="fa fa-check"></i><b>6.3.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="part5.html"><a href="part5.html#independent-samples-t-test"><i class="fa fa-check"></i><b>6.4</b> Independent-Samples <span class="math inline">\(t\)</span> Test</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="part5.html"><a href="part5.html#example-1"><i class="fa fa-check"></i><b>6.4.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="part5.html"><a href="part5.html#t-test-with-paired-data"><i class="fa fa-check"></i><b>6.5</b> <span class="math inline">\(t\)</span>-test with Paired Data</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="part5.html"><a href="part5.html#example-2"><i class="fa fa-check"></i><b>6.5.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="part5.html"><a href="part5.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>6.6</b> Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="part5.html"><a href="part5.html#example-3"><i class="fa fa-check"></i><b>6.6.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="part5.html"><a href="part5.html#exercise-9"><i class="fa fa-check"></i><b>6.7</b> Exercise 9</a></li>
<li class="chapter" data-level="6.8" data-path="part5.html"><a href="part5.html#additional-packages-to-consider"><i class="fa fa-check"></i><b>6.8</b> Additional Packages to Consider</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="part6.html"><a href="part6.html"><i class="fa fa-check"></i><b>7</b> Correlation and Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="part6.html"><a href="part6.html#correlation"><i class="fa fa-check"></i><b>7.1</b> Correlation</a></li>
<li class="chapter" data-level="7.2" data-path="part6.html"><a href="part6.html#simple-linear-regression"><i class="fa fa-check"></i><b>7.2</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="part6.html"><a href="part6.html#example-4"><i class="fa fa-check"></i><b>7.2.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="part6.html"><a href="part6.html#multiple-regression"><i class="fa fa-check"></i><b>7.3</b> Multiple Regression</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="part6.html"><a href="part6.html#example-5"><i class="fa fa-check"></i><b>7.3.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="part6.html"><a href="part6.html#exercise-10"><i class="fa fa-check"></i><b>7.4</b> Exercise 10</a></li>
<li class="chapter" data-level="7.5" data-path="part6.html"><a href="part6.html#additional-packages-to-consider-1"><i class="fa fa-check"></i><b>7.5</b> Additional Packages to Consider</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="part7.html"><a href="part7.html"><i class="fa fa-check"></i><b>8</b> Additional R Features</a>
<ul>
<li class="chapter" data-level="8.1" data-path="part7.html"><a href="part7.html#removing-objects-from-the-workspace"><i class="fa fa-check"></i><b>8.1</b> Removing Objects from the Workspace</a></li>
<li class="chapter" data-level="8.2" data-path="part7.html"><a href="part7.html#saving-output-in-r"><i class="fa fa-check"></i><b>8.2</b> Saving Output in R</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="part7.html"><a href="part7.html#using-the-sink-function"><i class="fa fa-check"></i><b>8.2.1</b> Using the <code>sink</code> Function</a></li>
<li class="chapter" data-level="8.2.2" data-path="part7.html"><a href="part7.html#saving-objects-from-an-r-session"><i class="fa fa-check"></i><b>8.2.2</b> Saving Objects from an <strong>R</strong> Session</a></li>
<li class="chapter" data-level="8.2.3" data-path="part7.html"><a href="part7.html#saving-the-history-of-an-r-session"><i class="fa fa-check"></i><b>8.2.3</b> Saving the History of an <strong>R</strong> Session</a></li>
<li class="chapter" data-level="8.2.4" data-path="part7.html"><a href="part7.html#using-r-markdown"><i class="fa fa-check"></i><b>8.2.4</b> Using R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="part7.html"><a href="part7.html#unloading-a-package"><i class="fa fa-check"></i><b>8.3</b> Unloading a Package</a></li>
<li class="chapter" data-level="8.4" data-path="part7.html"><a href="part7.html#updating-r-and-r-packages"><i class="fa fa-check"></i><b>8.4</b> Updating <strong>R</strong> and <strong>R</strong> Packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/okanbulut/rbook" target="blank">Published with GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Analysis and Visualizations Using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="part6" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Correlation and Regression</h1>
<div id="correlation" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Correlation</h2>
<p>Correlation measures the degree to which two variables are related to or associated with each other. It provides information on the strength and direction of relationships. The most widely used correlation index, also known as Pearson correlation, is</p>
<p><span class="math display">\[\text{For populations: } \rho = \frac{\sigma_{xy}}{\sigma_x \sigma_y}\]</span></p>
<p><span class="math display">\[\text{For samples: } r = \frac{S_{xy}}{S_x S_y}\]</span></p>
<p>Here are some notes on how to interpret correlations:</p>
<ul>
<li><p>Correlation can range from -1 to +1.</p></li>
<li><p>The sign (either - or +) shows the direction of the correlation</p></li>
<li><p>The value of correlation shows the magnitude of the correlation.</p></li>
<li><p>As correlations get closer to either -1 or +1, the strength increases.</p></li>
<li><p>Correlations near zero indicate very weak to no correlation.</p></li>
</ul>
<p>There are many guidelines for categorizing weak, moderate, and strong correlations. Typically, researchers refers to Cohen’s guidelines<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> as shown below:</p>
<table>
<thead>
<tr class="header">
<th align="center">Correlation</th>
<th align="center">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.1</td>
<td align="center">Small</td>
</tr>
<tr class="even">
<td align="center">0.3</td>
<td align="center">Moderate</td>
</tr>
<tr class="odd">
<td align="center">0.5</td>
<td align="center">Strong</td>
</tr>
</tbody>
</table>
<p>In <strong>R</strong>, the <code>cor()</code> function provides correlation coefficients and matrices. For the correlation between two variables (<code>depression1</code> and <code>mental1</code>):</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="part6.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(medical<span class="sc">$</span>depression1, medical<span class="sc">$</span>mental1)</span></code></pre></div>
<pre><code>[1] -0.6629</code></pre>
<p>For the correlation between multiple variables:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="part6.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(medical[, <span class="fu">c</span>(<span class="st">&quot;depression1&quot;</span>, <span class="st">&quot;mental1&quot;</span>, <span class="st">&quot;physical1&quot;</span>)])</span></code></pre></div>
<pre><code>            depression1  mental1 physical1
depression1      1.0000 -0.66289  -0.32000
mental1         -0.6629  1.00000   0.05698
physical1       -0.3200  0.05698   1.00000</code></pre>
<p>If some of the variables include missing values, then we can add either <code>use = "complete.obs"</code> (listwise deletion of missing cases) or <code>use = "pairwise.complete.obs"</code> (pairwise deletion of missing cases) inside the <code>cor</code> function.</p>
<p>To test the significance of the correlation, we can use the <code>correlate</code> function from the <code>lsr</code> package:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="part6.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Activate the package</span></span>
<span id="cb191-2"><a href="part6.html#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lsr&quot;</span>)</span>
<span id="cb191-3"><a href="part6.html#cb191-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-4"><a href="part6.html#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="fu">correlate</span>(medical[, <span class="fu">c</span>(<span class="st">&quot;depression1&quot;</span>, <span class="st">&quot;mental1&quot;</span>, <span class="st">&quot;physical1&quot;</span>)], </span>
<span id="cb191-5"><a href="part6.html#cb191-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">corr.method=</span><span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>
CORRELATIONS
============
- correlation type:  pearson 
- correlations shown only when both variables are numeric

            depression1    mental1    physical1   
depression1           .     -0.663***    -0.320***
mental1          -0.663***       .        0.057   
physical1        -0.320***   0.057            .   

---
Signif. codes: . = p &lt; .1, * = p&lt;.05, ** = p&lt;.01, *** = p&lt;.001


p-VALUES
========
- total number of tests run:  3 
- correction for multiple testing:  holm 

            depression1 mental1 physical1
depression1           .   0.000     0.000
mental1           0.000       .     0.373
physical1         0.000   0.373         .


SAMPLE SIZES
============

            depression1 mental1 physical1
depression1         246     246       246
mental1             246     246       246
physical1           246     246       246</code></pre>
<p>In addition to printing correlation matrices, <strong>R</strong> also provides nice ways to visualize correlations. In the following example, we will use the <code>corrplot</code> function from the <code>corrplot</code> package <span class="citation">(<a href="references.html#ref-R-corrplot" role="doc-biblioref">Wei and Simko 2017</a>)</span> to draw a correlation matrix plot<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="part6.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and activate the package</span></span>
<span id="cb193-2"><a href="part6.html#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;corrplot&quot;</span>)</span>
<span id="cb193-3"><a href="part6.html#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;corrplot&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="part6.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, we need to save the correlation matrix</span></span>
<span id="cb194-2"><a href="part6.html#cb194-2" aria-hidden="true" tabindex="-1"></a>cor_scores <span class="ot">&lt;-</span> <span class="fu">cor</span>(medical[, <span class="fu">c</span>(<span class="st">&quot;depression1&quot;</span>, <span class="st">&quot;mental1&quot;</span>, <span class="st">&quot;physical1&quot;</span>, </span>
<span id="cb194-3"><a href="part6.html#cb194-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;depression2&quot;</span>, <span class="st">&quot;mental2&quot;</span>, <span class="st">&quot;physical2&quot;</span>)])</span>
<span id="cb194-4"><a href="part6.html#cb194-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5"><a href="part6.html#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1 with circles</span></span>
<span id="cb194-6"><a href="part6.html#cb194-6" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_scores, <span class="at">method=</span><span class="st">&quot;circle&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:corplot1"></span>
<img src="rbook_files/figure-html/corplot1-1.png" alt="Correlation matrix plot with circles" width="768" />
<p class="caption">
Figure 7.1: Correlation matrix plot with circles
</p>
</div>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="part6.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2 with colors</span></span>
<span id="cb195-2"><a href="part6.html#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_scores, <span class="at">method=</span><span class="st">&quot;color&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:corplot2"></span>
<img src="rbook_files/figure-html/corplot2-1.png" alt="Correlation matrix plot with colours" width="768" />
<p class="caption">
Figure 7.2: Correlation matrix plot with colours
</p>
</div>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="part6.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3 with numbers</span></span>
<span id="cb196-2"><a href="part6.html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_scores, <span class="at">method=</span><span class="st">&quot;number&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:corplot3"></span>
<img src="rbook_files/figure-html/corplot3-1.png" alt="Correlation matrix plot with numbers" width="768" />
<p class="caption">
Figure 7.3: Correlation matrix plot with numbers
</p>
</div>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="part6.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 4 with circles + lower triangular</span></span>
<span id="cb197-2"><a href="part6.html#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_scores, <span class="at">method=</span><span class="st">&quot;circle&quot;</span>, <span class="at">type=</span><span class="st">&quot;lower&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:corplot4"></span>
<img src="rbook_files/figure-html/corplot4-1.png" alt="Correlation matrix plot with circle and lower triangle" width="768" />
<p class="caption">
Figure 7.4: Correlation matrix plot with circle and lower triangle
</p>
</div>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="part6.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 5 with circles + lower triangular + ordered correlations</span></span>
<span id="cb198-2"><a href="part6.html#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_scores, <span class="at">method=</span><span class="st">&quot;circle&quot;</span>, <span class="at">type=</span><span class="st">&quot;lower&quot;</span>, <span class="at">order=</span><span class="st">&quot;hclust&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:corplot5"></span>
<img src="rbook_files/figure-html/corplot5-1.png" alt="Correlation matrix plot with ordered correlations" width="768" />
<p class="caption">
Figure 7.5: Correlation matrix plot with ordered correlations
</p>
</div>
</div>
<div id="simple-linear-regression" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Simple Linear Regression</h2>
<p>Linear regression is a standard tool that researchers often rely on when analyzing the relationship between some predictors (i.e., independent variables) and an outcome (i.e., dependent variable). In a simple linear regression model, we aim to fit the best linear line to the data based on a single predictor so that the sum of residuals is the smallest. This method is known as “ordinaly least squares” (OLS). Once the regression equation is computed, we can use it to make predictions for a new sample of observations.</p>
<p>If <span class="math inline">\(Y\)</span> is the dependent variable (DV) and <span class="math inline">\(X\)</span> is the independent variable (IV), then the formula that describes our simple regression model becomes:</p>
<p><span class="math display">\[Y_i = b_1 X_i + b_0 + \epsilon_i\]</span></p>
<p>where <span class="math inline">\(b_1\)</span> is the slope (the increase in <span class="math inline">\(Y\)</span> for every one unit increase in <span class="math inline">\(X\)</span>), <span class="math inline">\(b_0\)</span> is the intercept (the value of <span class="math inline">\(Y\)</span> when <span class="math inline">\(X=0\)</span>), and <span class="math inline">\(\epsilon_i\)</span> is the residual (the difference between the predicted values based on the regression model and the actual values of the dependent variable).</p>
<p>In <strong>R</strong>, there are many ways to run regression analyses. However, the simplest way to run a regression model in <strong>R</strong> is to use the <code>lm()</code> function that fits a linear model to a given dataset (see <code>?lm</code> in the console for the help page). Here are the typical elements of <code>lm()</code>:</p>
<ul>
<li><code>formula</code>: A formula that specifies the regression model. This formula is of the form DV ~ IV.</li>
<li><code>data</code>: The data frame containing the variables.</li>
</ul>
<div id="example-4" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Example</h3>
<p>Now let’s see how regression works in <strong>R</strong>. We want to predict patients’ mental scores at the baseline (i.e., <code>mental1</code>) using their depression scores at the baseline (i.e., <code>depression1</code>). To see how this relationship looks like, we can first take a look at the scatterplot as well as the correlation between the two variables.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="part6.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(medical<span class="sc">$</span>depression1, medical<span class="sc">$</span>mental1)</span></code></pre></div>
<pre><code>[1] -0.6629</code></pre>
<p><span class="math inline">\(r = -.66\)</span> is indicating that there is a negative and moderate relationship between the two variables. Although we know that correlation does <strong>NOT</strong> mean causation, our knowledge or theory from the literature may suggest that these two variables are indeed associated with each other. So, we can move to the next step and plot these two variables in a scatterplot using the `<code>ggplot2</code> package (see <a href="http://sape.inf.usi.ch/quick-reference/ggplot2/colour" class="uri">http://sape.inf.usi.ch/quick-reference/ggplot2/colour</a> for many colour options in <code>ggplot2</code>).</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="part6.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Activate the ggplot2 first</span></span>
<span id="cb201-2"><a href="part6.html#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb201-3"><a href="part6.html#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="part6.html#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> medical, </span>
<span id="cb201-5"><a href="part6.html#cb201-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> depression1, <span class="at">y =</span> mental1)) <span class="sc">+</span> </span>
<span id="cb201-6"><a href="part6.html#cb201-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;grey25&quot;</span>) <span class="sc">+</span></span>
<span id="cb201-7"><a href="part6.html#cb201-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb201-8"><a href="part6.html#cb201-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Depression scores&quot;</span>, </span>
<span id="cb201-9"><a href="part6.html#cb201-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mental scores&quot;</span>,</span>
<span id="cb201-10"><a href="part6.html#cb201-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Scatterplot of depression and mental scores at the baseline&quot;</span>) <span class="sc">+</span></span>
<span id="cb201-11"><a href="part6.html#cb201-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:ggscatter5"></span>
<img src="rbook_files/figure-html/ggscatter5-1.png" alt="Scatterplot of depression and mental scores at the baseline" width="768" />
<p class="caption">
Figure 7.6: Scatterplot of depression and mental scores at the baseline
</p>
</div>
<p>The scatterplot also confirms that there is a negative relationship between the two variables. Now we can fit a regression model to the data to quantify this relationship.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="part6.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the model and save it as model1</span></span>
<span id="cb202-2"><a href="part6.html#cb202-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mental1 <span class="sc">~</span> depression1, <span class="at">data =</span> medical)</span>
<span id="cb202-3"><a href="part6.html#cb202-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-4"><a href="part6.html#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print basic model output</span></span>
<span id="cb202-5"><a href="part6.html#cb202-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model1)</span></code></pre></div>
<pre><code>
Call:
lm(formula = mental1 ~ depression1, data = medical)

Coefficients:
(Intercept)  depression1  
     53.948       -0.683  </code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="part6.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print detailed summary of the model</span></span>
<span id="cb204-2"><a href="part6.html#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code></pre></div>
<pre><code>
Call:
lm(formula = mental1 ~ depression1, data = medical)

Residuals:
    Min      1Q  Median      3Q     Max 
-27.152  -6.993   0.039   5.853  26.464 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  53.9477     1.7173    31.4   &lt;2e-16 ***
depression1  -0.6834     0.0494   -13.8   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 9.37 on 244 degrees of freedom
Multiple R-squared:  0.439, Adjusted R-squared:  0.437 
F-statistic:  191 on 1 and 244 DF,  p-value: &lt;2e-16</code></pre>
<p>The output shows that our regression equation is:</p>
<p><span class="math display">\[\hat{mental1} = 53.9477 - 0.6834(depression1)\]</span>
suggesting that one unit increase in the depression scores corresponds to -0.6834 points increase in the mental scores at the baseline.</p>
<p><code>t value</code> in the output indicates the individual <span class="math inline">\(t\)</span> tests for testing whether intercept and slope are significantly different from zero; i.e., <span class="math inline">\(H_0 = b_0 = 0\)</span> and <span class="math inline">\(H_0 = b_1 = 0\)</span>. The test for the intercept is not really interesting as we rarely care about whether or not the intercept is zero. However, for the slope, we want this test to be significant in order to conclude that the predictor is indeed useful for predicting the dependent variable. In our example, <span class="math inline">\(t = -13.8\)</span> for the slope and its p-value is less than .001. This indicates that the slope was significantly different from zero (i.e., an important predictor in our model). In the output <code>***</code> shows the level of significance.</p>
<p>Another important information is <span class="math inline">\(R^2\)</span>, which indicates the proportion of the variance explained by the predictor (<code>depression1</code>) in the dependent variable (<code>mental1</code>). In our model, <span class="math inline">\(R^2 = 0.439\)</span> – which means <span class="math inline">\(43.9%\)</span> of the variance in the mental scores can be explained by the depression scores.</p>
<p>There are many guidelines for categorizing for interpreting R-squared values. Researchers often refers to Cohen’s guidelines as shown below:</p>
<table>
<thead>
<tr class="header">
<th align="center">R-squared</th>
<th align="center">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.1</td>
<td align="center">Small</td>
</tr>
<tr class="even">
<td align="center">0.09</td>
<td align="center">Moderate</td>
</tr>
<tr class="odd">
<td align="center">0.25</td>
<td align="center">Large</td>
</tr>
</tbody>
</table>
<p>Using these guidelines, we can say that our model indicates a large effect between the dependent and independent variables.</p>
<p>Finally, the output has additional information about the overall significance of the regression model: <span class="math inline">\(F(1, 244) = 191, p &lt; .001\)</span>, suggesting that the model is statistically significant. This information may not be useful when we have a simple regression model because we already know that our predictor is significantly predicts the dependent variable. However, this information will be more useful when we look at multiple regression where only some variables might be significant, not all of them.</p>
</div>
</div>
<div id="multiple-regression" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Multiple Regression</h2>
<p>The simple linear regression model that we have discussed up to this point assumes that there is a single predictor variable that we are interested in. However, in many (perhaps most) research projects, we actually have multiple predictors that we want to examine. Therefore, we can extend the linear regression framework to be able to include multiple predictors – which is called <strong>multiple regression</strong>.</p>
<p>Multiple regression is conceptually very simple. All we do is to add more predictors into our regression equation. Let’s suppose that we are interested in predicting the mental scores at the baseline (<code>mental1</code>) using both the depression scores at the baseline (<code>depression1</code>), the physical scores at the baseline (<code>physical1</code>), and sex (<code>sex</code>). Our new regression equation should look like this:</p>
<p><span class="math display">\[\hat{mental1} = b_0 + b_1(depression1) + b_2(physical1) + b_3(sex)\]</span></p>
<p>We would hope that the additional variables we include in the model will make our regression model more precise. In other words, we will be able to better predict the mental scores with the help of these predictors. The caveat is that these two variables should be correlated with the dependent variable (i.e., mental scores) but they should not be highly correlated with each other or the other predictor (i.e., depression scores). If this is the case, adding new variables would not bring additional value to the regression model. Rather, the model would have some redundant variables.</p>
<div id="example-5" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Example</h3>
<p>Now let’s see how this will look like in <strong>R</strong>.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="part6.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add physical1 into the previous model</span></span>
<span id="cb206-2"><a href="part6.html#cb206-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mental1 <span class="sc">~</span> depression1 <span class="sc">+</span> physical1, <span class="at">data =</span> medical)</span>
<span id="cb206-3"><a href="part6.html#cb206-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-4"><a href="part6.html#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print detailed summary of the model</span></span>
<span id="cb206-5"><a href="part6.html#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code></pre></div>
<pre><code>
Call:
lm(formula = mental1 ~ depression1 + physical1, data = medical)

Residuals:
   Min     1Q Median     3Q    Max 
-23.51  -6.30  -0.45   6.11  26.79 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  64.9234     3.5619   18.23  &lt; 2e-16 ***
depression1  -0.7404     0.0510  -14.52  &lt; 2e-16 ***
physical1    -0.1920     0.0549   -3.49  0.00057 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 9.16 on 243 degrees of freedom
Multiple R-squared:  0.466, Adjusted R-squared:  0.462 
F-statistic:  106 on 2 and 243 DF,  p-value: &lt;2e-16</code></pre>
<p>The output shows that our new regression equation is:</p>
<p><span class="math display">\[\hat{mental1} = 64.92 -0.74(depression1) -0.19(physical1)\]</span></p>
<p>Both predictors negatively predict the mental scores and they are statistically significant in the model. Our R-squared value increased to <span class="math inline">\(R^2=0.466\)</span>, suggesting that <span class="math inline">\(46.6%\)</span> of the variance can be explained by the two predictors that we have in the model.</p>
<p>By looking at the slopes for each predictor, we <strong>cannot</strong> tell which predictor plays a more important role in the prediction. Therefore, we need to see the standardized slopes – which are directly comparable based on their magnitudes. We can use the <code>jtools</code> package <span class="citation">(<a href="references.html#ref-R-jtools" role="doc-biblioref">Long 2021</a>)</span> to visualize the standardized slopes. To use the <code>jtools</code> package, we have to install both <code>jtools</code> and <code>ggstance</code>.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="part6.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and activate the packages</span></span>
<span id="cb208-2"><a href="part6.html#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;jtools&quot;</span>, <span class="st">&quot;ggstance&quot;</span>))</span>
<span id="cb208-3"><a href="part6.html#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;jtools&quot;</span>)</span></code></pre></div>
<p>We will use the <code>plot_summ</code> function from the <code>jtools</code> package to visualize the slopes:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="part6.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(model2, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:regplot1"></span>
<img src="rbook_files/figure-html/regplot1-1.png" alt="Standardized regression coefficients in Model 2" width="768" />
<p class="caption">
Figure 7.7: Standardized regression coefficients in Model 2
</p>
</div>
<p>In the plot, the circles in the middle show the location of the standardized slopes (i.e., standardized regression coefficients) for both predictors and the line around the circles represent the confidence interval. We can see from Figure <a href="part6.html#fig:regplot1">7.7</a> that the standardized slope for <code>depression1</code> is much larger (around -8.5) whereas the standardized slope for <code>physical1</code> is smaller (around -2). So, we could say that the <code>depression1</code> is a stronger predictor than <code>physical1</code> in predicting <code>mental1</code>.</p>
<p>Let’s expand our model by adding <code>sex</code>. Because <code>sex</code> is a categorical variable, <strong>R</strong> will choose one level of this variable as the reference category and give the results for the other category. The default reference category is selected alphabetically. In the context of <code>sex</code>, the values are male and female. Because <strong>f</strong> alphabetically comes first, female will be selected as the reference category and we will see the results for male.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="part6.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add sex into the previous model</span></span>
<span id="cb210-2"><a href="part6.html#cb210-2" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mental1 <span class="sc">~</span> depression1 <span class="sc">+</span> physical1 <span class="sc">+</span> sex, <span class="at">data =</span> medical)</span>
<span id="cb210-3"><a href="part6.html#cb210-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-4"><a href="part6.html#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print detailed summary of the model</span></span>
<span id="cb210-5"><a href="part6.html#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code></pre></div>
<pre><code>
Call:
lm(formula = mental1 ~ depression1 + physical1 + sex, data = medical)

Residuals:
    Min      1Q  Median      3Q     Max 
-23.538  -6.409  -0.314   6.040  26.712 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  64.6403     3.7293   17.33  &lt; 2e-16 ***
depression1  -0.7386     0.0515  -14.33  &lt; 2e-16 ***
physical1    -0.1932     0.0552   -3.50  0.00056 ***
sexmale       0.3689     1.4105    0.26  0.79390    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 9.18 on 242 degrees of freedom
Multiple R-squared:  0.466, Adjusted R-squared:  0.46 
F-statistic: 70.5 on 3 and 242 DF,  p-value: &lt;2e-16</code></pre>
<p>The output shows that the estimated slope for <code>sexmale</code> is 0.37; but this slope is not statistically significant as its p-value is 0.79. We could probably conclude that <code>sex</code> does not explain any further variance in the model and therefore we can remove it from the model to keep our regression model simple.</p>
<p>So far we tested three models: Model 1, Model 2, and Model 3. Because the models are nested within each other (i.e., we incrementally added new variables), we can make a model comparison to see if adding those additional predictors brought significant added-value to the models with more predictors. We will use the <code>anova</code> function in base <strong>R</strong> to accomplish this. This function does not necessarily run the same ANOVA that we discussed earlier. It will compare the models based on their R-squared values.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="part6.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1, model2, model3)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Model 1: mental1 ~ depression1
Model 2: mental1 ~ depression1 + physical1
Model 3: mental1 ~ depression1 + physical1 + sex
  Res.Df   RSS Df Sum of Sq     F  Pr(&gt;F)    
1    244 21411                               
2    243 20387  1      1024 12.16 0.00058 ***
3    242 20381  1         6  0.07 0.79390    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In the output, there are two comparisons:</p>
<ul>
<li>Model 1 vs. Model 2</li>
<li>Model 2 vs. Model 3</li>
</ul>
<p>The comparison of Model 1 and Model 2 shows that <span class="math inline">\(F(1,1024)=12.16, p &lt; .001\)</span>, suggesting that the larger model (Model 2) explains significantly more variance than the smaller model (Model 1).</p>
<p>The comparison of Model 2 and Model 3 shows that <span class="math inline">\(F(1,6)=0.07, p=.793\)</span>, suggesting that the larger model (Model 3) does <strong>NOT</strong> explain significantly more variance than the smaller model (Model 2), which confirms our earlier finding that <code>sex</code> did not bring additional value to the model.</p>
<p>We can also compare the three models visually.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="part6.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(model1, model2, model3, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:regplot2"></span>
<img src="rbook_files/figure-html/regplot2-1.png" alt="Comparison of three models" width="768" />
<p class="caption">
Figure 7.8: Comparison of three models
</p>
</div>
</div>
</div>
<div id="exercise-10" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Exercise 10</h2>
<p>Run a multiple regression model where your dependent variable will be <code>depression2</code> (i.e., depression scores after 6 months) and your predictors will be:</p>
<ul>
<li><code>depression1</code> (i.e., depression scores at the baseline)</li>
<li><code>treat1</code> (i.e., whether the patient received treatment)</li>
<li><code>sex</code> (i.e., patients’ sex)</li>
</ul>
<p>The questions we can answer are:</p>
<ol style="list-style-type: decimal">
<li>Which variables are significant?</li>
<li>Do we need all three predictors?</li>
<li>How is the R-squared value for the model?</li>
</ol>
</div>
<div id="additional-packages-to-consider-1" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Additional Packages to Consider</h2>
<p>There are also additional <strong>R</strong> packages that might be useful when conducting regression analysis. In the last chapter, we used <strong>report</strong> (<a href="https://github.com/easystats/report" class="uri">https://github.com/easystats/report</a>) to produce reports of <span class="math inline">\(t\)</span>-tests. We can use the same package to create reports of regression models.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="part6.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Activate the package</span></span>
<span id="cb215-2"><a href="part6.html#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;report&quot;</span>)</span>
<span id="cb215-3"><a href="part6.html#cb215-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-4"><a href="part6.html#cb215-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mental1 <span class="sc">~</span> depression1 <span class="sc">+</span> physical1 <span class="sc">+</span> sex, <span class="at">data =</span> medical)</span>
<span id="cb215-5"><a href="part6.html#cb215-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-6"><a href="part6.html#cb215-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model parameters and additional information</span></span>
<span id="cb215-7"><a href="part6.html#cb215-7" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(model)</span></code></pre></div>
<pre><code>We fitted a linear model (estimated using OLS) to predict mental1 with depression1, physical1 and sex (formula: mental1 ~ depression1 + physical1 + sex). The model explains a significant and substantial proportion of variance (R2 = 0.47, F(3, 242) = 70.51, p &lt; .001, adj. R2 = 0.46). The model&#39;s intercept, corresponding to depression1 = 0, physical1 = 0 and sex = , is at 64.64 (95% CI [57.29, 71.99], t(242) = 17.33, p &lt; .001). Within this model:

  - The effect of depression1 is significantly negative (beta = -0.74, 95% CI [-0.84, -0.64], t(242) = -14.33, p &lt; .001; Std. beta = -0.72, 95% CI [-0.81, -0.62])
  - The effect of physical1 is significantly negative (beta = -0.19, 95% CI [-0.30, -0.08], t(242) = -3.50, p &lt; .001; Std. beta = -0.17, 95% CI [-0.27, -0.08])
  - The effect of sex [male] is non-significantly positive (beta = 0.37, 95% CI [-2.41, 3.15], t(242) = 0.26, p = 0.794; Std. beta = 0.03, 95% CI [-0.19, 0.25])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset.</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="part6.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or, print out specific parts of the model output</span></span>
<span id="cb217-2"><a href="part6.html#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="fu">report_model</span>(model)</span></code></pre></div>
<pre><code>linear model (estimated using OLS) to predict mental1 with depression1, physical1 and sex (formula: mental1 ~ depression1 + physical1 + sex)</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="part6.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report_performance</span>(model)</span></code></pre></div>
<pre><code>The model explains a significant and substantial proportion of variance (R2 = 0.47, F(3, 242) = 70.51, p &lt; .001, adj. R2 = 0.46)</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="part6.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report_statistics</span>(model)</span></code></pre></div>
<pre><code>beta = 64.64, 95% CI [57.29, 71.99], t(242) = 17.33, p &lt; .001; Std. beta = -0.02, 95% CI [-0.22, 0.17]
beta = -0.74, 95% CI [-0.84, -0.64], t(242) = -14.33, p &lt; .001; Std. beta = -0.72, 95% CI [-0.81, -0.62]
beta = -0.19, 95% CI [-0.30, -0.08], t(242) = -3.50, p &lt; .001; Std. beta = -0.17, 95% CI [-0.27, -0.08]
beta = 0.37, 95% CI [-2.41, 3.15], t(242) = 0.26, p = 0.794; Std. beta = 0.03, 95% CI [-0.19, 0.25]</code></pre>
<p>Another useful package for reporting regression results is <strong>parameters</strong> (<a href="https://github.com/easystats/parameters" class="uri">https://github.com/easystats/parameters</a>). The goal of this package is to facilitate and streamline the process of reporting results of statistical models, which includes the easy and intuitive calculation of standardized estimates or robust standard errors and p-values.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="part6.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install the activate the package</span></span>
<span id="cb223-2"><a href="part6.html#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;parameters&quot;</span>)</span>
<span id="cb223-3"><a href="part6.html#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;parameters&quot;</span>)</span>
<span id="cb223-4"><a href="part6.html#cb223-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-5"><a href="part6.html#cb223-5" aria-hidden="true" tabindex="-1"></a><span class="co"># To view regular model parameters</span></span>
<span id="cb223-6"><a href="part6.html#cb223-6" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(model)</span>
<span id="cb223-7"><a href="part6.html#cb223-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-8"><a href="part6.html#cb223-8" aria-hidden="true" tabindex="-1"></a><span class="co"># To view standardized model parameters</span></span>
<span id="cb223-9"><a href="part6.html#cb223-9" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(model, <span class="at">standardize =</span> <span class="st">&quot;refit&quot;</span>)</span></code></pre></div>
<pre><code>Parameter   | Coefficient |   SE |         95% CI | t(242) |      p
-------------------------------------------------------------------
(Intercept) |       64.64 | 3.73 | [57.29, 71.99] |  17.33 | &lt; .001
depression1 |       -0.74 | 0.05 | [-0.84, -0.64] | -14.33 | &lt; .001
physical1   |       -0.19 | 0.06 | [-0.30, -0.08] |  -3.50 | &lt; .001
sex [male]  |        0.37 | 1.41 | [-2.41,  3.15] |   0.26 | 0.794 </code></pre>
<pre><code>Parameter   | Coefficient |   SE |         95% CI | t(242) |      p
-------------------------------------------------------------------
(Intercept) |       -0.02 | 0.10 | [-0.22,  0.17] |  -0.23 | 0.818 
depression1 |       -0.72 | 0.05 | [-0.81, -0.62] | -14.33 | &lt; .001
physical1   |       -0.17 | 0.05 | [-0.27, -0.08] |  -3.50 | &lt; .001
sex [male]  |        0.03 | 0.11 | [-0.19,  0.25] |   0.26 | 0.794 </code></pre>
<p>Lastly, <strong>performance</strong> (<a href="https://github.com/easystats/performance" class="uri">https://github.com/easystats/performance</a>) is another useful package for evaluating the quality of model fit for regression models. The package provides several fit indices to evaluate model fit. Also, it has data visualization tools that facilitate model diagnostics.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="part6.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install the activate the package</span></span>
<span id="cb226-2"><a href="part6.html#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;performance&quot;</span>)</span>
<span id="cb226-3"><a href="part6.html#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;performance&quot;</span>)</span>
<span id="cb226-4"><a href="part6.html#cb226-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-5"><a href="part6.html#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Model performance summaries</span></span>
<span id="cb226-6"><a href="part6.html#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(model)</span>
<span id="cb226-7"><a href="part6.html#cb226-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-8"><a href="part6.html#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for heteroskedasticity</span></span>
<span id="cb226-9"><a href="part6.html#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="fu">check_heteroscedasticity</span>(model)</span>
<span id="cb226-10"><a href="part6.html#cb226-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-11"><a href="part6.html#cb226-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Comprehensive visualization of model checks</span></span>
<span id="cb226-12"><a href="part6.html#cb226-12" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(model)</span></code></pre></div>
<pre><code># Indices of model performance

AIC      |      BIC |    R2 | R2 (adj.) |  RMSE | Sigma
-------------------------------------------------------
1794.707 | 1812.234 | 0.466 |     0.460 | 9.102 | 9.177</code></pre>
<pre><code>OK: Error variance appears to be homoscedastic (p = 0.346).</code></pre>
<p><img src="rbook_files/figure-html/ch6_16-1.png" width="768" style="display: block; margin: auto;" /></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p><strong>Source:</strong> <a href="http://imaging.mrc-cbu.cam.ac.uk/statswiki/FAQ/effectSize" class="uri">http://imaging.mrc-cbu.cam.ac.uk/statswiki/FAQ/effectSize</a><a href="part6.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>The <strong>Gally</strong> package also includes a function called <code>ggcorr</code> to draw correlation matrix plots. Check out this nice tutorial: <a href="https://briatte.github.io/ggcorr/" class="uri">https://briatte.github.io/ggcorr/</a> <a href="part6.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="part5.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="part7.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/okanbulut/rbook/tree/master/06-part6.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["rbook.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
